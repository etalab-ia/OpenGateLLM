general:
  log_level: DEBUG

auth:
  master_key: changeme

usages:
  routers: ["all"]
  tokenizer: "tiktoken_gpt2"

web_search:
  - type: brave
    model: albert-small
    args:
      api_key: ${BRAVE_API_KEY}

multi_agents_search:
  model: albert-small

databases:
  - type: qdrant
    model: embeddings-small
    args:
      url: http://${QDRANT_HOST}:8333
      api_key: changeme
      grpc_port: 8334
      prefer_grpc: True
      timeout: 10

  - type: redis
    args:
      host: ${REDIS_HOST}
      port: 8335
      password: changeme

  - type: sql
    context: api
    args:
      url: postgresql+asyncpg://postgres:changeme@${POSTGRES_HOST}:8432/api
      echo: False
      pool_size: 5
      max_overflow: 10
      pool_pre_ping: True
      connect_args:
        server_settings:
          statement_timeout: "120s"

models:
  - id: albert-large
    type: image-text-to-text
    owned_by: test
    aliases: ["mistralai/Mistral-Small-3.1-24B-Instruct-2503"]
    clients:
      - model: albert-large
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 120

  - id: albert-small
    type: text-generation
    routing_strategy: round_robin
    aliases: ["meta-llama/Llama-3.1-8B-Instruct"]
    clients:
      - model: albert-small
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 120
      - model: albert-small
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 60

  - id: embeddings-small
    type: text-embeddings-inference
    aliases: ["BAAI/bge-m3"]
    clients:
      - model: embeddings-small
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 120

  - id: audio-large
    type: automatic-speech-recognition
    aliases: ["openai/whisper-large-v3"]
    clients: 
      - model: audio-large
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 120

  - id: rerank-small
    type: text-classification
    aliases: ["BAAI/bge-reranker-v2-m3"]
    clients:
      - model: rerank-small
        type: albert
        args:
          api_url: https://albert.api.etalab.gouv.fr
          api_key: ${ALBERT_API_KEY}
          timeout: 120
